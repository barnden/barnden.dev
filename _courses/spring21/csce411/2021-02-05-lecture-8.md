---
layout: note
title:  "Lower Bounds for Comparison Based Sorting"
date:   2021-02-05 12:02:24 -0600
categories: csce 411
semester: spring21
---
<figcaption>Some sections from lecture 7 (3 Feb. 2021) and this lecture were merged into this post.</figcaption>

## Theorem
> Any comparison based sorting algorithm is bounded below by \\(\Omega(n\log n)\\) on inputs of \\(n\\) elements.

----------

## Proof
Let \\(\mathcal{M}\\) be such an algorithm. For a given input \\(a = (a_1, a_2, \dots, a_n)\\), there exists a binary decision tree which the algorithm follows based on each comparison's result. Eventually \\(\mathcal{M}(a)\\) will end at a leaf node on the decision tree, which corresponds to the sorted output of the input \\(a\\). (For this exercise, sps. the function \\(\mathcal{M}(a)\\) returns a leaf of the execution tree, rather than the sorted input.)

Sps. we gave \\(\mathcal{M}\\) permutations of \\(a\\), rather than \\(a\\) itself, let the set of permutations be \\(\Pi = \\{\pi_1, \pi_2, \dots, \pi_{n!}\\}\\). Then, for any two unique permutations \\(\pi_a, \pi_b \in \Pi\\), \\(\mathcal{M}(\pi_a) = \mathcal{M}(\pi_b)\\)  must mean that \\(\mathcal{M}(\pi_a)\\) and \\(\mathcal{M}(\pi_b)\\) followed the same execution path, which is impossible if \\(\mathcal{M}\\) is a sorting algorithm. Therefore, by way of contradiction, we have that \\(\mathcal{M}(\pi_a) \neq \mathcal{M}(\pi_b)\\).

The decision tree is a binary tree, as such it has a height \\(h\\). The number of nodes in the last layer of the decision tree must be less than or equal to \\(2^h\\). From above, we now have \\(\forall \pi \in \Pi,\ \exists!\,\mathcal{M}(\pi)\\), if \\(\mathcal{M}(\pi)\\) is a leaf, then \\(2^h \geq n!\\) because \\(\|\Pi\| = n!\\). It then follows, that \\(\mathcal{M}\\) must have at minimum \\(h\\) steps, or is bounded by \\(\Omega(h)\\).

Solving for \\(h\\).

$$
\begin{align}
2^h &\geq n!\\
h &\geq \log n!\\
&\geq \log\left[\left(\frac{n}{2}\right)^{\frac{n}{2}}\right] \tag*{\scriptsize{(See: Sterling's Approximation)}}\\
&\geq \frac{n}{2}\log\frac{n}{2}\\
&\geq \frac{n}{2}(\log n - 1)\\
&\geq \frac{n}{2}\log(n) - \frac{n}{2}\\
&\geq \frac{1}{4}n\log n\ \forall\,n \geq 4.
\end{align}
$$

Therefore, if \\(\mathcal{M}\\) is bounded by \\(\Omega(h)\\), from above we have that \\(\mathcal{M}\\) is boundad by \\(\Omega(n\log n)\\).

QED.
